"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2280],{85506:(e,t,r)=>{r.d(t,{hI:()=>i,jR:()=>o}),r(59253),r(14585);var a=r(48370);function i(e){try{if(!e||"object"!=typeof e)throw new a.yI("Invalid user object provided");if(!Array.isArray(e.providerData))return!1;return e.providerData.some(e=>e&&"password"===e.providerId)}catch(t){return a.r_.handle(t,{function:"isEmailPasswordUser",userId:null==e?void 0:e.uid}),!1}}function o(e){try{if(!e||"object"!=typeof e)throw new a.yI("Invalid user object provided");if(!Array.isArray(e.providerData))return!1;return e.providerData.some(e=>e&&"google.com"===e.providerId)}catch(t){return a.r_.handle(t,{function:"isGoogleUser",userId:null==e?void 0:e.uid}),!1}}},92280:(e,t,r)=>{r.d(t,{AuthProvider:()=>y,A:()=>m});var a=r(95155),i=r(12115),o=r(59253),n=r(14585),s=r(69975),d=r(19708);async function l(){if(!n.db)throw Error("Firestore is not initialized.");return await (0,d.c4)(n.db,async e=>{let t=(0,d.H9)(n.db,"metadata","userCounter"),r=await e.get(t),a=1;return r.exists()&&(a=(r.data().lastUserId||0)+1),e.set(t,{lastUserId:a,updatedAt:new Date},{merge:!0}),a})}async function u(e){if(!n.db)throw Error("Firestore is not initialized.");try{var t,r,a,i;let o=(0,d.H9)(n.db,"users",e),s=await (0,d.x7)(o);if(!s.exists())return null;let l=s.data();return{uid:l.uid,userId:l.userId,email:l.email,displayName:l.displayName,photoURL:l.photoURL,createdAt:(null==(t=l.createdAt)?void 0:t.toDate())||new Date,lastSignInTime:(null==(r=l.lastSignInTime)?void 0:r.toDate())||null,profileCreatedAt:null==(a=l.profileCreatedAt)?void 0:a.toDate(),profileUpdatedAt:null==(i=l.profileUpdatedAt)?void 0:i.toDate()}}catch(e){throw e}}async function c(e){if(!n.db)throw Error("Firestore is not initialized.");try{let t=await l(),r=new Date,a={uid:e.uid,userId:t,email:e.email,displayName:e.displayName,photoURL:e.photoURL,createdAt:r,lastSignInTime:r},i=(0,d.H9)(n.db,"users",e.uid);return await (0,d.BN)(i,{...a,profileCreatedAt:(0,d.O5)(),profileUpdatedAt:(0,d.O5)()}),{...a,profileCreatedAt:r,profileUpdatedAt:r}}catch(e){throw e}}async function h(e){if(!n.db)throw Error("Firestore is not initialized.");try{let t=(0,d.H9)(n.db,"users",e);await (0,d.mZ)(t,{lastSignInTime:(0,d.O5)(),profileUpdatedAt:(0,d.O5)()})}catch(e){throw e}}async function f(e){if(!n.db)throw Error("Firestore is not initialized.");try{let t=(0,d.H9)(n.db,"users",e);await (0,d.kd)(t)}catch(e){throw e}}var p=r(85506);let w=(0,i.createContext)(void 0);function y(e){let{children:t}=e,[r,d]=(0,i.useState)(null),[l,y]=(0,i.useState)(null),[m,g]=(0,i.useState)(!0);(0,i.useEffect)(()=>{let e=setTimeout(()=>{m&&g(!1)},1e4);return()=>clearTimeout(e)},[m]),(0,i.useEffect)(()=>{if(!n.j)return void g(!1);let e=(0,o.hg)(n.j,async e=>{if(d(e),e)try{let t=await u(e.uid);t?await h(e.uid):t=await c(e),y(t)}catch(e){y(null)}else y(null);g(!1)},e=>{g(!1)}),t=setTimeout(()=>{g(!1)},5e3);return(0,o.Q4)(n.j).then(e=>{(null==e?void 0:e.user)&&(0,s.Md)("signed in with Google")}).catch(e=>{(0,s.Jf)("Failed to complete sign-in. Please try again.")}).finally(()=>{setTimeout(()=>g(!1),1e3)}),()=>{clearTimeout(t),e()}},[]);let v=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!n.j||!n.h)return void(0,s.Jf)("Firebase authentication is not properly initialized.");try{g(!0),e?await (0,o.$2)(n.j,n.h):(await (0,o.df)(n.j,n.h),(0,s.Md)("signed in with Google"))}catch(a){let t="Failed to sign in with Google. Please try again.",r=!1;if("auth/popup-blocked"===a.code)t="Popup blocked. Trying redirect method...",r=!0;else if("auth/popup-closed-by-user"===a.code)t="Sign-in popup was closed. Please try again.";else if("auth/unauthorized-domain"===a.code){let e=window.location.hostname;t="Domain '".concat(e,"' is not authorized. Please add it to Firebase Console > Authentication > Settings > Authorized domains.")}else"auth/invalid-api-key"===a.code?t="Invalid API key. Please check Firebase configuration.":"auth/operation-not-allowed"===a.code?t="Google sign-in is not enabled. Please enable it in Firebase Console.":"auth/invalid-oauth-client-id"===a.code?t="OAuth client configuration error. Please check Google Cloud Console.":a.message&&a.message.includes("invalid")&&(t="OAuth configuration error. Please check Google Cloud Console settings.");if((0,s.Jf)(t),r&&!e)return void setTimeout(()=>v(!0),2e3)}finally{e||g(!1)}},b=async(e,t)=>{if(!n.j)throw(0,s.Jf)("Firebase authentication is not properly initialized."),Error("Firebase auth not initialized");try{g(!0),await (0,o.x9)(n.j,e,t),(0,s.Md)("signed in")}catch(t){let e="Failed to sign in. Please check your credentials.";throw"auth/user-not-found"===t.code?e="No account found with this email address.":"auth/wrong-password"===t.code?e="Incorrect password. Please try again.":"auth/invalid-email"===t.code?e="Invalid email address format.":"auth/user-disabled"===t.code?e="This account has been disabled.":"auth/too-many-requests"===t.code?e="Too many failed attempts. Please try again later.":"auth/network-request-failed"===t.code&&(e="Network error. Please check your connection."),(0,s.Jf)(e),t}finally{g(!1)}},P=async(e,t)=>{if(!n.j)throw(0,s.Jf)("Firebase authentication is not properly initialized."),Error("Firebase auth not initialized");try{g(!0);let r=(await (0,o.eJ)(n.j,e,t)).user;try{await c(r)}catch(e){}(0,s.Md)("account created successfully")}catch(t){let e="Failed to create account. Please try again.";throw"auth/email-already-in-use"===t.code?e="An account with this email address already exists.":"auth/invalid-email"===t.code?e="Invalid email address format.":"auth/weak-password"===t.code?e="Password is too weak. Please use at least 6 characters.":"auth/operation-not-allowed"===t.code?e="Email/password sign-up is not enabled.":"auth/network-request-failed"===t.code?e="Network error. Please check your connection.":"auth/too-many-requests"===t.code&&(e="Too many attempts. Please try again later."),(0,s.Jf)(e),t}finally{g(!1)}},A=async e=>{if(!n.j)throw(0,s.Jf)("Firebase authentication is not properly initialized."),Error("Firebase auth not initialized");try{await (0,o.J1)(n.j,e),(0,s.GF)("Password Reset Sent","Check your email for password reset instructions.")}catch(t){let e="Failed to send password reset email.";throw"auth/user-not-found"===t.code?e="No account found with this email address.":"auth/invalid-email"===t.code?e="Invalid email address format.":"auth/too-many-requests"===t.code&&(e="Too many requests. Please try again later."),(0,s.Jf)(e),t}},I=async()=>{if(!n.j)return void(0,s.Jf)("Firebase authentication is not properly initialized.");try{g(!0),await (0,o.CI)(n.j),(0,s.GF)("Successfully signed out!","You have been safely logged out of your account.")}catch(e){(0,s.Jf)("Failed to sign out. Please try again.")}finally{g(!1)}},F=async e=>{if(!r)return void(0,s.Jf)("No user is currently signed in.");try{if(g(!0),(0,p.hI)(r)&&!e)throw Error("Password is required to delete your account.");try{if((0,p.hI)(r)){if(!e)throw Error("Password is required to delete your account.");if(r.email){let t=o.IX.credential(r.email,e);await (0,o.kZ)(r,t)}}else if((0,p.jR)(r)){if(!n.h)throw Error("Google provider is not initialized");await (0,o.Bm)(r,n.h)}}catch(e){if("auth/popup-blocked"===e.code)throw Error("Popup was blocked. Please allow popups and try again.");if("auth/popup-closed-by-user"===e.code)throw Error("Authentication popup was closed. Please try again.");if("auth/wrong-password"===e.code)throw Error("Incorrect password. Please try again.");throw e}try{await f(r.uid)}catch(e){}await (0,o.hG)(r),(0,s.GF)("Account Deleted","Your account has been permanently deleted.")}catch(t){let e="Failed to delete account. Please try again.";throw"auth/requires-recent-login"===t.code?e="For security reasons, please provide your password again to delete your account.":"auth/user-not-found"===t.code?e="User account not found.":"auth/wrong-password"===t.code?e="Incorrect password. Please try again.":t.message&&(e=t.message),(0,s.Jf)(e),t}finally{g(!1)}};return(0,a.jsx)(w.Provider,{value:{user:r,userProfile:l,loading:m,signInWithGoogle:v,signInWithEmail:b,signUpWithEmail:P,resetPassword:A,logout:I,deleteAccount:F},children:t})}function m(){let e=(0,i.useContext)(w);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}}]);